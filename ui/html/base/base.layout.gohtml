{{define "base"}}
    <!doctype html>
    <html lang='en'>
    <head>
        <meta charset='UTF-8'>
        <meta name='viewport'
              content='width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0'>
        <meta http-equiv='X-UA-Compatible' content='ie=edge'>
        <title>{{template "title" .}} - Blogalusta</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
              crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
        <link rel='stylesheet' href='/static/css/custom.css'>
    </head>
    <body class='d-flex flex-column min-vh-100'>
    <header>
        <nav class='navbar navbar-expand'>
            <div class='container'>
                <div class='navbar-brand col-md-4' title='Blogalusta homepage'>
                    <a class='d-md-none h1' href='/'>B</a>
                    <a class='d-md-block d-none' href='/'>Blogalusta</a>
                </div>
                {{with $publication := $.Publication}}
                    <div class='mr-auto text-truncate' title='{{$publication.Name}}'>
                        <a class='text-body fw-bold d-md-none' href='{{$publication.GetBaseURL}}'>{{$publication.Name}}</a>
                        <a class='text-body fw-bold h2 d-md-block d-none' href='{{$publication.GetBaseURL}}'>{{$publication.Name}}</a>
                    </div>
                {{end}}
                <div class='col col-md-4 d-flex flex-column'>
                    <ul class='navbar-nav align-self-end'>
                        {{$user := $.AuthenticatedUser}}
                        {{if $user}}
                            {{block "nav" .}}
                                {{template "newarticleuser" .}}
                            {{end}}
                            <li class='nav-item dropdown'>
                                <a href='#' class='dropdown-toggle dropdown-toggle-remove' data-bs-toggle='dropdown'>
                                    <img class='rounded-circle' src='{{userPic $user}}'
                                         alt='Profile pic' width='40'>
                                </a>
                                <ul class='dropdown-menu dropdown-menu-end' style='min-width: max-content'>
                                    <li class='container dropdown-item'>
                                        <div class='row align-items-center position-relative'>
                                            <div class='col col-auto'>
                                                <img class='rounded-circle' src='{{userPic $user}}'
                                                     alt='Profile pic' width='64'>
                                            </div>
                                            <div class='col text-truncate'>
                                                <a href='{{userURL $user}}'
                                                   class='stretched-link px-0'>
                                                    <b class='text-body'>{{$user.Name}}</b>
                                                </a>
                                                <br>
                                                <small class='card-text'>{{$user.Email}}</small>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <hr class='dropdown-divider'>
                                    </li>
                                    <li>
                                        <a href='{{userURL $user}}' class='dropdown-item py-2'>
                                            <i class='bi-person'></i>&nbsp;Profile
                                        </a>
                                    </li>
                                    <li>
                                        <a href='/user/invitations' class='dropdown-item py-2'>
                                            <i class='bi-envelope'></i>&nbsp;Invitations
                                        </a>
                                    </li>
                                    <li>
                                        <a href='/user/settings' class='dropdown-item py-2'>
                                            <i class='bi-gear'></i>&nbsp;Settings
                                        </a>
                                    </li>
                                    <li>
                                        <hr class='dropdown-divider'>
                                    </li>
                                    <li>
                                        <form action='/user/logout' method='post'>
                                            {{template "csrf" $}}
                                            <button type='submit' class='dropdown-item py-2'>
                                                <i class='bi-box-arrow-in-left'></i>&nbsp;Logout
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </li>
                        {{else}}
                            <li class='nav-item'><a href='/user/signup' class='nav-link'>Signup</a></li>
                            <li class='nav-item'><a href='/user/login' class='nav-link'>Login</a></li>
                        {{end}}
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    {{with .Flash}}
        <div class='text-center alert alert-danger'>
            {{.}}
        </div>
    {{else}}
        <hr class='mt-0'>
    {{end}}
    <section class='container-md'>
        {{template "body" .}}
    </section>
    {{template "footer" .}}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
    </body>
    </html>
{{end}}